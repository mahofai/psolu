No path specified. Models will be saved in: "AutogluonModels/ag-20230724_071612/"
Presets specified: ['medium_quality']
Beginning AutoGluon training ... Time limit = 1000000s
AutoGluon will save models to "AutogluonModels/ag-20230724_071612/"
AutoGluon Version:  0.8.2
Python Version:     3.9.16
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Thu Jun 10 13:32:12 UTC 2021
Disk Space Avail:   250965.67 GB / 595935.30 GB (42.1%)
Train Data Rows:    8281
Train Data Columns: 17010
Tuning Data Rows:    2943
Tuning Data Columns: 17010
Label Column: solubility
Preprocessing data ...
AutoGluon infers your prediction problem is: 'binary' (because only two unique label-values observed).
	2 unique label values:  [1, 0]
	If 'binary' is not the correct problem_type, please manually specify the problem_type parameter during predictor init (You may specify problem_type as one of: ['binary', 'multiclass', 'regression'])
Selected class <--> label mapping:  class 1 = 1, class 0 = 0
Using Feature Generators to preprocess the data ...
Fitting IdentityFeatureGenerator...
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
Data preprocessing and feature engineering runtime = 9.32s ...
AutoGluon will gauge predictive performance using evaluation metric: 'precision'
	To change this, specify the eval_metric parameter of Predictor()
User-specified model hyperparameters to be fit:
{
	'NN_TORCH': {},
	'GBM': [{'extra_trees': True, 'ag_args': {'name_suffix': 'XT'}}, {}, 'GBMLarge'],
	'CAT': {},
	'XGB': {},
	'FASTAI': {},
	'RF': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
	'XT': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
	'KNN': [{'weights': 'uniform', 'ag_args': {'name_suffix': 'Unif'}}, {'weights': 'distance', 'ag_args': {'name_suffix': 'Dist'}}],
}
Fitting 13 L1 models ...
Fitting model: KNeighborsUnif ... Training model for up to 999990.68s of the 999989.3s of remaining time.
	No valid features to train KNeighborsUnif... Skipping this model.
Fitting model: KNeighborsDist ... Training model for up to 999985.67s of the 999984.28s of remaining time.
	No valid features to train KNeighborsDist... Skipping this model.
Fitting model: LightGBMXT ... Training model for up to 999980.67s of the 999979.28s of remaining time.
	0.7216	 = Validation score   (precision)
	33.36s	 = Training   runtime
	0.41s	 = Validation runtime
Fitting model: LightGBM ... Training model for up to 999945.13s of the 999943.73s of remaining time.
	0.7216	 = Validation score   (precision)
	28.94s	 = Training   runtime
	0.62s	 = Validation runtime
Fitting model: RandomForestGini ... Training model for up to 999913.64s of the 999912.23s of remaining time.
	0.7082	 = Validation score   (precision)
	21.9s	 = Training   runtime
	0.25s	 = Validation runtime
Fitting model: RandomForestEntr ... Training model for up to 999889.38s of the 999888.01s of remaining time.
	0.706	 = Validation score   (precision)
	21.38s	 = Training   runtime
	0.32s	 = Validation runtime
Fitting model: CatBoost ... Training model for up to 999865.72s of the 999864.33s of remaining time.
	0.727	 = Validation score   (precision)
	436.14s	 = Training   runtime
	10.61s	 = Validation runtime
Fitting model: ExtraTreesGini ... Training model for up to 999417.28s of the 999415.89s of remaining time.
	0.7106	 = Validation score   (precision)
	30.21s	 = Training   runtime
	0.3s	 = Validation runtime
Fitting model: ExtraTreesEntr ... Training model for up to 999384.87s of the 999383.35s of remaining time.
	0.7053	 = Validation score   (precision)
	28.94s	 = Training   runtime
	0.62s	 = Validation runtime
Fitting model: NeuralNetFastAI ... Training model for up to 999352.99s of the 999350.75s of remaining time.
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
	0.802	 = Validation score   (precision)
	2424.16s	 = Training   runtime
	71.3s	 = Validation runtime
Fitting model: XGBoost ... Training model for up to 996851.59s of the 996850.15s of remaining time.
	0.7314	 = Validation score   (precision)
	76.0s	 = Training   runtime
	0.29s	 = Validation runtime
Fitting model: NeuralNetTorch ... Training model for up to 996772.28s of the 996770.88s of remaining time.
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/torch/nn/init.py:405: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
	Warning: Exception caused NeuralNetTorch to fail during training... Skipping this model.
		list index out of range
Detailed Traceback:
Traceback (most recent call last):
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/trainer/abstract_trainer.py", line 1733, in _train_and_save
    model = self._train_single(X, y, model, X_val, y_val, total_resources=total_resources, **model_fit_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/trainer/abstract_trainer.py", line 1684, in _train_single
    model = model.fit(X=X, y=y, X_val=X_val, y_val=y_val, total_resources=total_resources, **model_fit_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/models/abstract/abstract_model.py", line 829, in fit
    out = self._fit(**kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/tabular_nn_torch.py", line 207, in _fit
    self._train_net(
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/tabular_nn_torch.py", line 307, in _train_net
    loss = self.model.compute_loss(data_batch, **loss_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/torch_network_modules.py", line 233, in compute_loss
    predict_data = self(data_batch)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/torch_network_modules.py", line 174, in forward
    input_data = input_data[0]
IndexError: list index out of range
Fitting model: LightGBMLarge ... Training model for up to 996753.42s of the 996752.01s of remaining time.
	0.7146	 = Validation score   (precision)
	35.34s	 = Training   runtime
	0.44s	 = Validation runtime
Fitting model: WeightedEnsemble_L2 ... Training model for up to 99999.07s of the 996710.61s of remaining time.
	0.8623	 = Validation score   (precision)
	2.36s	 = Training   runtime
	0.01s	 = Validation runtime
AutoGluon training complete, total runtime = 3294.11s ... Best model: "WeightedEnsemble_L2"
TabularPredictor saved. To load, use: predictor = TabularPredictor.load("AutogluonModels/ag-20230724_071612/")
Evaluation: precision on test data: 0.8393782383419689
Evaluations on test data:
{
    "precision": 0.8393782383419689,
    "accuracy": 0.46258503401360546,
    "balanced_accuracy": 0.5639749927160854,
    "mcc": 0.1743616413017101,
    "roc_auc": 0.6366264857951318,
    "f1": 0.31304347826086953,
    "recall": 0.19239904988123516
}
Evaluation: precision on test data: 0.8622540250447227
Evaluations on test data:
{
    "precision": 0.8622540250447227,
    "accuracy": 0.5742439687393815,
    "balanced_accuracy": 0.6461403296170625,
    "mcc": 0.275701222672928,
    "roc_auc": 0.7594547327369674,
    "f1": 0.6060987110971392,
    "recall": 0.46728065923412504
}
{'valid_raw_types': ['object']}
 !!!!!quality: medium_quality
!!!!alpha 0.5
{'valid_raw_types': ['object']}
one hot encoding protein!!!!
one_hot_train_data1.shape: (8281, 17011)
one_hot_valid_data1.shape: (2943, 17011)
one_hot_test_data.shape: (1323, 17012)
!!!!!medium quality!!!!!!
[1000]	valid_set's binary_logloss: 0.631722	valid_set's precision: 0.720213
[1000]	valid_set's binary_logloss: 0.631722	valid_set's precision: 0.720213
test eval: {'precision': 0.8393782383419689, 'accuracy': 0.46258503401360546, 'balanced_accuracy': 0.5639749927160854, 'mcc': 0.1743616413017101, 'roc_auc': 0.6366264857951318, 'f1': 0.31304347826086953, 'recall': 0.19239904988123516}
valid eval: {'precision': 0.8622540250447227, 'accuracy': 0.5742439687393815, 'balanced_accuracy': 0.6461403296170625, 'mcc': 0.275701222672928, 'roc_auc': 0.7594547327369674, 'f1': 0.6060987110971392, 'recall': 0.46728065923412504}
