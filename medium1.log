No path specified. Models will be saved in: "AutogluonModels/ag-20230724_102451/"
Warning: Training may take a very long time because `time_limit` was not specified and `train_data` is large (8281 samples, 140.93 MB).
	Consider setting `time_limit` to ensure training finishes within an expected duration or experiment with a small portion of `train_data` to identify an ideal `presets` and `hyperparameters` configuration.
Beginning AutoGluon training ...
AutoGluon will save models to "AutogluonModels/ag-20230724_102451/"
AutoGluon Version:  0.8.2
Python Version:     3.9.16
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Thu Jun 10 13:32:12 UTC 2021
Disk Space Avail:   251112.36 GB / 595935.30 GB (42.1%)
Train Data Rows:    8281
Train Data Columns: 17010
Tuning Data Rows:    2943
Tuning Data Columns: 17010
Label Column: solubility
Preprocessing data ...
AutoGluon infers your prediction problem is: 'binary' (because only two unique label-values observed).
	2 unique label values:  [1, 0]
	If 'binary' is not the correct problem_type, please manually specify the problem_type parameter during predictor init (You may specify problem_type as one of: ['binary', 'multiclass', 'regression'])
Selected class <--> label mapping:  class 1 = 1, class 0 = 0
Using Feature Generators to preprocess the data ...
Fitting IdentityFeatureGenerator...
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
Data preprocessing and feature engineering runtime = 9.26s ...
AutoGluon will gauge predictive performance using evaluation metric: 'precision'
	To change this, specify the eval_metric parameter of Predictor()
User-specified model hyperparameters to be fit:
{
	'NN_TORCH': {},
	'GBM': [{'extra_trees': True, 'ag_args': {'name_suffix': 'XT'}}, {}, 'GBMLarge'],
	'CAT': {},
	'XGB': {},
	'FASTAI': {},
	'RF': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
	'XT': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
	'KNN': [{'weights': 'uniform', 'ag_args': {'name_suffix': 'Unif'}}, {'weights': 'distance', 'ag_args': {'name_suffix': 'Dist'}}],
}
Fitting 13 L1 models ...
Fitting model: KNeighborsUnif ...
	No valid features to train KNeighborsUnif... Skipping this model.
Fitting model: KNeighborsDist ...
	No valid features to train KNeighborsDist... Skipping this model.
Fitting model: LightGBMXT ...
	0.7216	 = Validation score   (precision)
	30.82s	 = Training   runtime
	0.45s	 = Validation runtime
Fitting model: LightGBM ...
	0.7216	 = Validation score   (precision)
	29.66s	 = Training   runtime
	0.41s	 = Validation runtime
Fitting model: RandomForestGini ...
	0.7082	 = Validation score   (precision)
	21.77s	 = Training   runtime
	0.24s	 = Validation runtime
Fitting model: RandomForestEntr ...
	0.706	 = Validation score   (precision)
	21.72s	 = Training   runtime
	0.3s	 = Validation runtime
Fitting model: CatBoost ...
	0.727	 = Validation score   (precision)
	427.92s	 = Training   runtime
	11.32s	 = Validation runtime
Fitting model: ExtraTreesGini ...
	0.7106	 = Validation score   (precision)
	21.76s	 = Training   runtime
	0.26s	 = Validation runtime
Fitting model: ExtraTreesEntr ...
	0.7053	 = Validation score   (precision)
	21.11s	 = Training   runtime
	0.52s	 = Validation runtime
Fitting model: NeuralNetFastAI ...
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
No improvement since epoch 6: early stopping
	0.7816	 = Validation score   (precision)
	2277.83s	 = Training   runtime
	71.71s	 = Validation runtime
Fitting model: XGBoost ...
	0.7314	 = Validation score   (precision)
	92.78s	 = Training   runtime
	0.3s	 = Validation runtime
Fitting model: NeuralNetTorch ...
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/torch/nn/init.py:405: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
	Warning: Exception caused NeuralNetTorch to fail during training... Skipping this model.
		list index out of range
Detailed Traceback:
Traceback (most recent call last):
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/trainer/abstract_trainer.py", line 1733, in _train_and_save
    model = self._train_single(X, y, model, X_val, y_val, total_resources=total_resources, **model_fit_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/trainer/abstract_trainer.py", line 1684, in _train_single
    model = model.fit(X=X, y=y, X_val=X_val, y_val=y_val, total_resources=total_resources, **model_fit_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/models/abstract/abstract_model.py", line 829, in fit
    out = self._fit(**kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/tabular_nn_torch.py", line 207, in _fit
    self._train_net(
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/tabular_nn_torch.py", line 307, in _train_net
    loss = self.model.compute_loss(data_batch, **loss_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/torch_network_modules.py", line 233, in compute_loss
    predict_data = self(data_batch)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/torch_network_modules.py", line 174, in forward
    input_data = input_data[0]
IndexError: list index out of range
Fitting model: LightGBMLarge ...
	0.7146	 = Validation score   (precision)
	36.47s	 = Training   runtime
	0.5s	 = Validation runtime
Fitting model: WeightedEnsemble_L2 ...
	0.7821	 = Validation score   (precision)
	2.52s	 = Training   runtime
	0.01s	 = Validation runtime
AutoGluon training complete, total runtime = 3132.58s ... Best model: "WeightedEnsemble_L2"
TabularPredictor saved. To load, use: predictor = TabularPredictor.load("AutogluonModels/ag-20230724_102451/")
Evaluation: precision on test data: 0.6981132075471698
Evaluations on test data:
{
    "precision": 0.6981132075471698,
    "accuracy": 0.5699168556311414,
    "balanced_accuracy": 0.569413237465494,
    "mcc": 0.13367390655304753,
    "roc_auc": 0.6100957526135673,
    "f1": 0.6283474853037231,
    "recall": 0.5712589073634204
}
Evaluation: precision on test data: 0.7821100917431193
Evaluations on test data:
{
    "precision": 0.7821100917431193,
    "accuracy": 0.7169554875976895,
    "balanced_accuracy": 0.6433467919622791,
    "mcc": 0.29951488335292975,
    "roc_auc": 0.6935131428193715,
    "f1": 0.8036766438840443,
    "recall": 0.8264663111972855
}
 !!!!!quality: medium_quality
!!!!alpha 0.5
{'valid_raw_types': ['object']}
one hot encoding protein!!!!
(8281, 17011)
(2943, 17011)
(1323, 17011)
       aa1_C  aa2_C  aa3_C  aa4_C  ...  aa808_X  aa809_X  aa810_X  solubility
1      False  False  False  False  ...    False    False    False           1
2      False  False  False  False  ...    False    False    False           1
3      False  False  False  False  ...    False    False    False           1
4      False  False  False  False  ...    False    False    False           1
5      False  False  False  False  ...    False    False    False           0
...      ...    ...    ...    ...  ...      ...      ...      ...         ...
11213  False  False  False  False  ...    False    False    False           0
11215  False  False  False  False  ...    False    False    False           1
11216  False  False  False  False  ...    False    False    False           0
11217  False  False  False  False  ...    False    False    False           0
11223  False  False  False  False  ...    False    False    False           0

[8281 rows x 17011 columns]
      aa1_C  aa2_C  aa3_C  aa4_C  ...  aa808_X  aa809_X  aa810_X  solubility
0     False  False  False  False  ...    False    False    False           0
1     False  False  False  False  ...    False    False    False           0
2     False  False  False  False  ...    False    False    False           0
3     False  False  False  False  ...    False    False    False           1
4     False  False  False  False  ...    False    False    False           1
...     ...    ...    ...    ...  ...      ...      ...      ...         ...
1318  False  False  False  False  ...    False    False    False           1
1319  False  False  False  False  ...    False    False    False           1
1320  False  False  False  False  ...    False    False    False           1
1321  False  False  False  False  ...    False    False    False           1
1322  False  False  False  False  ...    False    False    False           1

[1323 rows x 17011 columns]
!!!!!medium quality!!!!!!
[1000]	valid_set's binary_logloss: 0.631722	valid_set's precision: 0.720213
[1000]	valid_set's binary_logloss: 0.631722	valid_set's precision: 0.720213
test eval: {'precision': 0.6981132075471698, 'accuracy': 0.5699168556311414, 'balanced_accuracy': 0.569413237465494, 'mcc': 0.13367390655304753, 'roc_auc': 0.6100957526135673, 'f1': 0.6283474853037231, 'recall': 0.5712589073634204}
valid eval: {'precision': 0.7821100917431193, 'accuracy': 0.7169554875976895, 'balanced_accuracy': 0.6433467919622791, 'mcc': 0.29951488335292975, 'roc_auc': 0.6935131428193715, 'f1': 0.8036766438840443, 'recall': 0.8264663111972855}
