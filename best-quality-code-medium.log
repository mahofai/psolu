No path specified. Models will be saved in: "AutogluonModels/ag-20230724_104051/"
Warning: Training may take a very long time because `time_limit` was not specified and `train_data` is large (8281 samples, 140.93 MB).
	Consider setting `time_limit` to ensure training finishes within an expected duration or experiment with a small portion of `train_data` to identify an ideal `presets` and `hyperparameters` configuration.
Beginning AutoGluon training ...
AutoGluon will save models to "AutogluonModels/ag-20230724_104051/"
AutoGluon Version:  0.8.2
Python Version:     3.9.16
Operating System:   Linux
Platform Machine:   x86_64
Platform Version:   #1 SMP Thu Jun 10 13:32:12 UTC 2021
Disk Space Avail:   251100.92 GB / 595935.30 GB (42.1%)
Train Data Rows:    8281
Train Data Columns: 17010
Label Column: solubility
Preprocessing data ...
AutoGluon infers your prediction problem is: 'binary' (because only two unique label-values observed).
	2 unique label values:  [1, 0]
	If 'binary' is not the correct problem_type, please manually specify the problem_type parameter during predictor init (You may specify problem_type as one of: ['binary', 'multiclass', 'regression'])
Selected class <--> label mapping:  class 1 = 1, class 0 = 0
Using Feature Generators to preprocess the data ...
Fitting IdentityFeatureGenerator...
	Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
Data preprocessing and feature engineering runtime = 9.03s ...
AutoGluon will gauge predictive performance using evaluation metric: 'mcc'
	To change this, specify the eval_metric parameter of Predictor()
Automatically generating train/validation split with holdout_frac=0.1, Train Rows: 7452, Val Rows: 829
User-specified model hyperparameters to be fit:
{
	'NN_TORCH': {},
	'GBM': [{'extra_trees': True, 'ag_args': {'name_suffix': 'XT'}}, {}, 'GBMLarge'],
	'CAT': {},
	'XGB': {},
	'FASTAI': {},
	'RF': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
	'XT': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
	'KNN': [{'weights': 'uniform', 'ag_args': {'name_suffix': 'Unif'}}, {'weights': 'distance', 'ag_args': {'name_suffix': 'Dist'}}],
}
Fitting 13 L1 models ...
Fitting model: KNeighborsUnif ...
	No valid features to train KNeighborsUnif... Skipping this model.
Fitting model: KNeighborsDist ...
	No valid features to train KNeighborsDist... Skipping this model.
Fitting model: LightGBMXT ...
	0.3198	 = Validation score   (mcc)
	25.3s	 = Training   runtime
	0.14s	 = Validation runtime
Fitting model: LightGBM ...
	0.3198	 = Validation score   (mcc)
	23.65s	 = Training   runtime
	0.1s	 = Validation runtime
Fitting model: RandomForestGini ...
	0.2848	 = Validation score   (mcc)
	22.32s	 = Training   runtime
	0.15s	 = Validation runtime
Fitting model: RandomForestEntr ...
	0.2939	 = Validation score   (mcc)
	22.24s	 = Training   runtime
	0.15s	 = Validation runtime
Fitting model: CatBoost ...
	0.2985	 = Validation score   (mcc)
	151.92s	 = Training   runtime
	3.6s	 = Validation runtime
Fitting model: ExtraTreesGini ...
	0.2988	 = Validation score   (mcc)
	21.72s	 = Training   runtime
	0.14s	 = Validation runtime
Fitting model: ExtraTreesEntr ...
	0.3015	 = Validation score   (mcc)
	21.67s	 = Training   runtime
	0.15s	 = Validation runtime
Fitting model: NeuralNetFastAI ...
Metric mcc is not supported by this model - using log_loss instead
No improvement since epoch 1: early stopping
	-0.0252	 = Validation score   (mcc)
	1602.56s	 = Training   runtime
	25.91s	 = Validation runtime
Fitting model: XGBoost ...
	0.3337	 = Validation score   (mcc)
	60.24s	 = Training   runtime
	0.11s	 = Validation runtime
Fitting model: NeuralNetTorch ...
/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/torch/nn/init.py:405: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
	Warning: Exception caused NeuralNetTorch to fail during training... Skipping this model.
		list index out of range
Detailed Traceback:
Traceback (most recent call last):
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/trainer/abstract_trainer.py", line 1733, in _train_and_save
    model = self._train_single(X, y, model, X_val, y_val, total_resources=total_resources, **model_fit_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/trainer/abstract_trainer.py", line 1684, in _train_single
    model = model.fit(X=X, y=y, X_val=X_val, y_val=y_val, total_resources=total_resources, **model_fit_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/core/models/abstract/abstract_model.py", line 829, in fit
    out = self._fit(**kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/tabular_nn_torch.py", line 207, in _fit
    self._train_net(
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/tabular_nn_torch.py", line 307, in _train_net
    loss = self.model.compute_loss(data_batch, **loss_kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/torch_network_modules.py", line 233, in compute_loss
    predict_data = self(data_batch)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/user/mahaohui/miniconda3/envs/automl/lib/python3.9/site-packages/autogluon/tabular/models/tabular_nn/torch/torch_network_modules.py", line 174, in forward
    input_data = input_data[0]
IndexError: list index out of range
Fitting model: LightGBMLarge ...
	0.3307	 = Validation score   (mcc)
	45.13s	 = Training   runtime
	0.21s	 = Validation runtime
Fitting model: WeightedEnsemble_L2 ...
	0.3337	 = Validation score   (mcc)
	1.78s	 = Training   runtime
	0.0s	 = Validation runtime
AutoGluon training complete, total runtime = 2092.24s ... Best model: "WeightedEnsemble_L2"
TabularPredictor saved. To load, use: predictor = TabularPredictor.load("AutogluonModels/ag-20230724_104051/")
{'valid_raw_types': ['object']}
one hot encoding protein!!!!
(8281, 17011)
(2943, 17011)
(1323, 17011)
       aa1_C  aa2_C  aa3_C  aa4_C  ...  aa808_X  aa809_X  aa810_X  solubility
1      False  False  False  False  ...    False    False    False           1
2      False  False  False  False  ...    False    False    False           1
3      False  False  False  False  ...    False    False    False           1
4      False  False  False  False  ...    False    False    False           1
5      False  False  False  False  ...    False    False    False           0
...      ...    ...    ...    ...  ...      ...      ...      ...         ...
11213  False  False  False  False  ...    False    False    False           0
11215  False  False  False  False  ...    False    False    False           1
11216  False  False  False  False  ...    False    False    False           0
11217  False  False  False  False  ...    False    False    False           0
11223  False  False  False  False  ...    False    False    False           0

[8281 rows x 17011 columns]
      aa1_C  aa2_C  aa3_C  aa4_C  ...  aa808_X  aa809_X  aa810_X  solubility
0     False  False  False  False  ...    False    False    False           0
1     False  False  False  False  ...    False    False    False           0
2     False  False  False  False  ...    False    False    False           0
3     False  False  False  False  ...    False    False    False           1
4     False  False  False  False  ...    False    False    False           1
...     ...    ...    ...    ...  ...      ...      ...      ...         ...
1318  False  False  False  False  ...    False    False    False           1
1319  False  False  False  False  ...    False    False    False           1
1320  False  False  False  False  ...    False    False    False           1
1321  False  False  False  False  ...    False    False    False           1
1322  False  False  False  False  ...    False    False    False           1

[1323 rows x 17011 columns]
valid_eva: {'mcc': 0.14188714251376702, 'accuracy': 0.6986068637444784, 'balanced_accuracy': 0.5475017075750231, 'roc_auc': 0.5767998391574494, 'f1': 0.8111560570576963, 'precision': 0.7232346241457859, 'recall': 0.9234125060591372}
test_eva: {'mcc': 0.06765720266907921, 'accuracy': 0.6213151927437641, 'balanced_accuracy': 0.5242233371687054, 'roc_auc': 0.5907118977190237, 'f1': 0.7473524962178518, 'precision': 0.64943032427695, 'recall': 0.8800475059382423}
